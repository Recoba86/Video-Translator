<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø²ÛŒØ±Ù†ÙˆÛŒØ³ Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ§Ø±Ø³ÛŒ - AI Video Subtitler</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FFA726 0%, #42A5F5 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #FFA726;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        input[type="url"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            direction: ltr;
        }

        input[type="url"]:focus {
            outline: none;
            border-color: #42A5F5;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #FFA726 0%, #42A5F5 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .status {
            margin-top: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
            display: none;
        }

        .status.show {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFA726 0%, #42A5F5 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .message {
            text-align: center;
            font-size: 18px;
            color: #333;
            margin: 10px 0;
        }

        .stage-info {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .stage-info.warning {
            background: #fff3cd;
            border-color: #ff9800;
        }

        .stage-info.translating {
            background: #e3f2fd;
            border-color: #2196f3;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .stage-title {
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 10px;
            color: #ff9800;
        }

        .stage-description {
            color: #666;
            line-height: 1.6;
            margin-top: 8px;
        }

        .warning-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .error {
            background: #fee;
            border: 2px solid #fcc;
            color: #c00;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .success {
            background: #efe;
            border: 2px solid #cfc;
            color: #060;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .video-result {
            margin-top: 20px;
        }

        video {
            width: 100%;
            border-radius: 10px;
            margin-top: 15px;
        }

        .download-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45B049 100%);
            margin-top: 15px;
        }
        
        .download-btn:hover {
            background: linear-gradient(135deg, #45B049 0%, #4CAF50 100%);
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #42A5F5;
            font-size: 14px;
            font-weight: 500;
        }
        
        .timing-info {
            background: linear-gradient(135deg, #FFF3E0 0%, #E3F2FD 100%);
            border: 2px solid #FFA726;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: right;
        }
        
        .timing-title {
            font-size: 18px;
            font-weight: bold;
            color: #FF9800;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .total-time {
            font-size: 24px;
            font-weight: bold;
            color: #42A5F5;
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .stage-timing {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 15px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            border-right: 4px solid #FFA726;
        }
        
        .stage-name {
            color: #555;
            font-size: 15px;
        }
        
        .stage-duration {
            color: #42A5F5;
            font-weight: bold;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ Ø²ÛŒØ±Ù†ÙˆÛŒØ³ Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ§Ø±Ø³ÛŒ</h1>
        <p class="subtitle">AI Video Subtitler with Persian Translation</p>

        <form method="POST" action="/simple/process">
            {% if not task_id %}
            <div class="form-group">
                <label for="video_url">Ø¢Ø¯Ø±Ø³ ÙˆÛŒØ¯Ø¦Ùˆ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:</label>
                <input 
                    type="url" 
                    id="video_url" 
                    name="video_url" 
                    required 
                    placeholder="https://www.youtube.com/watch?v=..."
                >
            </div>
            {% endif %}

            {% if not task_id %}
            <button type="submit">â–¶ Ø´Ø±ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø²Ø´</button>
            {% endif %}
        </form>

        {% if task_id %}
        <div class="status show">
            <div class="message">{{ message }}</div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: {{ progress }}%">
                    {{ progress }}%
                </div>
            </div>

            {% if status == 'downloading' %}
            <div class="stage-info">
                <div class="stage-title">â¬ Ù…Ø±Ø­Ù„Ù‡ Û± Ø§Ø² Ûµ: Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙˆÛŒØ¯Ø¦Ùˆ</div>
                <div class="stage-description">
                    ÙˆÛŒØ¯Ø¦Ùˆ Ø§Ø² Ø³Ø±ÙˆØ± ÛŒÙˆØªÛŒÙˆØ¨ ÛŒØ§ Ù¾Ù„ØªÙØ±Ù… Ø¯ÛŒÚ¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯.<br>
                    Ø²Ù…Ø§Ù† Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¨Ù‡ Ø­Ø¬Ù… ÙˆÛŒØ¯Ø¦Ùˆ Ùˆ Ø³Ø±Ø¹Øª Ø§ÛŒÙ†ØªØ±Ù†Øª Ø´Ù…Ø§ Ø¨Ø³ØªÚ¯ÛŒ Ø¯Ø§Ø±Ø¯.
                </div>
            </div>
            {% elif status == 'transcribing' %}
            <div class="stage-info translating">
                <div class="warning-icon">â³</div>
                <div class="stage-title">ğŸ¤ Ù…Ø±Ø­Ù„Ù‡ Û² Ø§Ø² Ûµ: Ø±ÙˆÙ†ÙˆÛŒØ³ÛŒ ØµÙˆØª</div>
                <div class="stage-description">
                    <strong style="color: #1976d2;">ğŸ”„ Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª...</strong><br><br>
                    Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Whisper Ø¯Ø± Ø­Ø§Ù„ ØªØ¨Ø¯ÛŒÙ„ ØµØ¯Ø§ÛŒ ÙˆÛŒØ¯Ø¦Ùˆ Ø¨Ù‡ Ù…ØªÙ† Ø§Ø³Øª.<br>
                    Ø²Ù…Ø§Ù† ØªÙ‚Ø±ÛŒØ¨ÛŒ: <strong>Û³Û°-Û¶Û° Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¯Ù‚ÛŒÙ‚Ù‡ ÙˆÛŒØ¯Ø¦Ùˆ</strong><br><br>
                    <strong style="color: #f57c00;">âš™ï¸ ØªÙˆØ¬Ù‡:</strong> Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ù‡ÛŒÚ† progress Ø¨ØµØ±ÛŒ Ù†Ø¯Ø§Ø±Ø¯!<br>
                    Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¨Ù‡ Ù†Ø¸Ø± Ø¨Ø±Ø³Ø¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ "Ú¯ÛŒØ± Ú©Ø±Ø¯Ù‡" Ø§Ù…Ø§ Ø¯Ø± ÙˆØ§Ù‚Ø¹ <strong>Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª</strong>.<br><br>
                    <strong style="color: #e65100;">ğŸš¨ Ù„Ø·ÙØ§Ù‹ ØµØ¨ÙˆØ± Ø¨Ø§Ø´ÛŒØ¯ Ùˆ ØªØ¨ Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù†Ø¨Ù†Ø¯ÛŒØ¯!</strong><br>
                    ØµÙØ­Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± Û² Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
                </div>
            </div>
            {% elif status == 'translating' %}
            <div class="stage-info translating">
                <div class="warning-icon">âš ï¸</div>
                <div class="stage-title">ğŸŒ Ù…Ø±Ø­Ù„Ù‡ Û³ Ø§Ø² Ûµ: ØªØ±Ø¬Ù…Ù‡ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ</div>
                <div class="stage-description">
                    <strong style="color: #d32f2f;">â° Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø²Ù…Ø§Ù†â€ŒØ¨Ø± Ø§Ø³Øª!</strong><br><br>
                    Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Gemini Ø¯Ø± Ø­Ø§Ù„ ØªØ±Ø¬Ù…Ù‡ Ù…ØªÙ† Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ Ø§Ø³Øª.<br>
                    Ø²Ù…Ø§Ù† ØªÙ‚Ø±ÛŒØ¨ÛŒ: <strong>Û±-Û² Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¬Ù…Ù„Ù‡</strong><br>
                    Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ¯Ø¦ÙˆÙ‡Ø§ÛŒ Ø¨Ù„Ù†Ø¯ØªØ± Ø§Ø² Û³Û° Ø«Ø§Ù†ÛŒÙ‡ØŒ Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ú†Ù†Ø¯ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø·ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ø´Ø¯.<br><br>
                    <strong style="color: #e65100;">ğŸš¨ Ù„Ø·ÙØ§Ù‹ ØªØ¨ Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù†Ø¨Ù†Ø¯ÛŒØ¯ Ùˆ ØµØ¨ÙˆØ± Ø¨Ø§Ø´ÛŒØ¯!</strong><br>
                    ØµÙØ­Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± Û² Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
                </div>
            </div>
            {% elif status == 'generating_subtitles' %}
            <div class="stage-info">
                <div class="stage-title">ğŸ“ Ù…Ø±Ø­Ù„Ù‡ Û´ Ø§Ø² Ûµ: Ø³Ø§Ø®Øª ÙØ§ÛŒÙ„ Ø²ÛŒØ±Ù†ÙˆÛŒØ³</div>
                <div class="stage-description">
                    ÙØ§ÛŒÙ„ Ø²ÛŒØ±Ù†ÙˆÛŒØ³ SRT Ø¨Ø§ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ù‚ÛŒÙ‚ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.<br>
                    Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹ Ø§Ø³Øª (Ú©Ù…ØªØ± Ø§Ø² Û± Ø«Ø§Ù†ÛŒÙ‡).
                </div>
            </div>
            {% elif status == 'burning_subtitles' %}
            <div class="stage-info">
                <div class="stage-title">ğŸ¬ Ù…Ø±Ø­Ù„Ù‡ Ûµ Ø§Ø² Ûµ: Ú†Ø³Ø¨Ø§Ù†Ø¯Ù† Ø²ÛŒØ±Ù†ÙˆÛŒØ³ Ø¨Ù‡ ÙˆÛŒØ¯Ø¦Ùˆ</div>
                <div class="stage-description">
                    FFmpeg Ø¯Ø± Ø­Ø§Ù„ Ú†Ø³Ø¨Ø§Ù†Ø¯Ù† Ø²ÛŒØ±Ù†ÙˆÛŒØ³ ÙØ§Ø±Ø³ÛŒ Ø¨Ù‡ ÙˆÛŒØ¯Ø¦Ùˆ Ø§Ø³Øª.<br>
                    Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¨Ù‡ Ø·ÙˆÙ„ ÙˆÛŒØ¯Ø¦Ùˆ Ø¨Ø³ØªÚ¯ÛŒ Ø¯Ø§Ø±Ø¯ (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ûµ-Û±Ûµ Ø«Ø§Ù†ÛŒÙ‡).<br>
                    <strong>ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹ ØªÙ…Ø§Ù… Ø´Ø¯! ğŸ‰</strong>
                </div>
            </div>
            {% elif status == 'started' %}
            <div class="stage-info">
                <div class="stage-title">ğŸš€ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ</div>
                <div class="stage-description">
                    Ø³ÛŒØ³ØªÙ… Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙˆÛŒØ¯Ø¦Ùˆ Ø§Ø³Øª...<br>
                    Ù„Ø·ÙØ§Ù‹ Ú†Ù†Ø¯ Ù„Ø­Ø¸Ù‡ ØµØ¨Ø± Ú©Ù†ÛŒØ¯.
                </div>
            </div>
            {% endif %}

            {% if status == 'completed' %}
            <div class="success">
                âœ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!
                
                {% if timing %}
                <div class="timing-info">
                    <div class="timing-title">â±ï¸ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´</div>
                    <div class="total-time">
                        â° Ø²Ù…Ø§Ù† Ú©Ù„: {{ "%.1f"|format(timing.total_duration if timing.total_duration else 0) }} Ø«Ø§Ù†ÛŒÙ‡
                    </div>
                    {% if timing.stages.downloading %}
                    <div class="stage-timing">
                        <span class="stage-name">ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙˆÛŒØ¯Ø¦Ùˆ</span>
                        <span class="stage-duration">{{ "%.1f"|format(timing.stages.downloading.duration if timing.stages.downloading.duration else 0) }} Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                    {% endif %}
                    {% if timing.stages.transcribing %}
                    <div class="stage-timing">
                        <span class="stage-name">ğŸ¤ Ø±ÙˆÙ†ÙˆÛŒØ³ÛŒ ØµÙˆØª</span>
                        <span class="stage-duration">{{ "%.1f"|format(timing.stages.transcribing.duration if timing.stages.transcribing.duration else 0) }} Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                    {% endif %}
                    {% if timing.stages.translating %}
                    <div class="stage-timing">
                        <span class="stage-name">ğŸŒ ØªØ±Ø¬Ù…Ù‡ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ</span>
                        <span class="stage-duration">{{ "%.1f"|format(timing.stages.translating.duration if timing.stages.translating.duration else 0) }} Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                    {% endif %}
                    {% if timing.stages.generating_subtitles %}
                    <div class="stage-timing">
                        <span class="stage-name">ğŸ“ Ø³Ø§Ø®Øª Ø²ÛŒØ±Ù†ÙˆÛŒØ³</span>
                        <span class="stage-duration">{{ "%.1f"|format(timing.stages.generating_subtitles.duration if timing.stages.generating_subtitles.duration else 0) }} Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                    {% endif %}
                    {% if timing.stages.burning_subtitles %}
                    <div class="stage-timing">
                        <span class="stage-name">ğŸ¬ Ú†Ø³Ø¨Ø§Ù†Ø¯Ù† Ø²ÛŒØ±Ù†ÙˆÛŒØ³</span>
                        <span class="stage-duration">{{ "%.1f"|format(timing.stages.burning_subtitles.duration if timing.stages.burning_subtitles.duration else 0) }} Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
                
                <div class="video-result">
                    <video controls>
                        <source src="/api/preview/{{ output_file }}" type="video/mp4">
                    </video>
                    <form method="GET" action="/api/download/{{ output_file }}">
                        <button type="submit" class="download-btn">â¬‡ï¸ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ù†Ù‡Ø§ÛŒÛŒ</button>
                    </form>
                    <form method="POST" action="/simple/process">
                        <button type="submit" style="background: linear-gradient(135deg, #FF9800 0%, #FB8C00 100%); margin-top: 10px;">ğŸ”„ Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙˆÛŒØ¯Ø¦Ùˆ Ø¬Ø¯ÛŒØ¯</button>
                    </form>
                </div>
            </div>
            {% elif status == 'failed' %}
            <div class="error">
                âŒ Ø®Ø·Ø§: {{ message }}
                <form method="POST" action="/simple/process">
                    <button type="submit" style="margin-top: 15px;">ğŸ”„ ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯</button>
                </form>
            </div>
            {% else %}
            <meta http-equiv="refresh" content="2">
            <p style="text-align: center; color: #666; margin-top: 15px;">
                â³ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´... ØµÙØ­Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            </p>
            {% endif %}
        </div>
        {% endif %}

        <div class="footer">
            Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· ÙˆÛŒØªØ§Ù…ÛŒÙ† ØªÙˆØ³Ø· Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆÛŒØªØ§Ù…ÛŒÙ†ÛŒ Ù‡Ø§<br>
            <small>Powered by Whisper + Gemini 2.5 Flash</small>
        </div>
    </div>
</body>
</html>
